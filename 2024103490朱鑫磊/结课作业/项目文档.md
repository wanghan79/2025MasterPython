# 蛋白质链间原子冲突检测工具：文档说明

## 一、项目目标

本工具旨在检测蛋白质复合物中不同链之间的原子级别结构冲突（Clash），特别是判断链间是否存在距离小于阈值（如 1.1 Å）的原子对。这类冲突通常反映出结构预测中的不合理之处，可用于模型结构质量评估与筛选。

## 二、核心功能
PDB 结构解析：

1. 使用 Bio.PDB 读取 .pdb 文件，提取每个原子的三维坐标。

2. 同时记录每个原子所属的残基索引（atom_to_token_idx）及对应链的标识符（asym_id）。

冲突检测核心模块（Clash 类）：

1. 通过 forward() 方法，完成主计算流程，支持 CPU 与 GPU。

2. 根据 asym_id 生成每条链的掩码，提取链内原子坐标。

3. 遍历链对，利用 torch.cdist 计算链间所有原子对的欧式距离。

4. 若任意两个原子距离小于阈值（如 1.1 Å），即判断为存在 clash。

5. 统计每对链的 clash 原子对数量（total_clash） 和 相对冲突比（relative_clash）。

评估与接口封装：

1. 提供 compute_clash_statistics_cpu() 和 compute_clash_statistics_gpu() 两种实现，分别在 CPU 和 GPU 上运行。

2. 返回冲突统计结果，包括：所有链对的总冲突数；每对链的相对冲突比（用于评估冲突强度）。

## 三、主要逻辑结构

PDB 文件 → 坐标与链信息提取 → 构建 Clash 检测器 → 逐链对距离矩阵计算 → 判断冲突 → 结果汇总




<br><br>















如需使用，只需替换测试脚本中的 PDB 文件路径为目标蛋白复合物的路径，即可运行检测并输出 CPU/GPU 的运行耗时及冲突统计信息。
